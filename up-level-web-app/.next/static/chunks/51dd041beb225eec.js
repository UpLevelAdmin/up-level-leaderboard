(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6004,e=>{"use strict";let t=(0,e.i(27162).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],6004)},37978,e=>{"use strict";let t=(0,e.i(27162).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],37978)},89862,e=>{"use strict";let t=(0,e.i(27162).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],89862)},25664,e=>{"use strict";let t=(0,e.i(27162).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],25664)},94556,e=>{"use strict";e.i(18355);var t=e.i(70395),s=e.i(7951),l=e.i(81291),a=e.i(1805),i=e.i(53636),r=s,n=e.i(18760);class c extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function o({children:e,isPresent:s}){let l=(0,r.useId)(),a=(0,r.useRef)(null),i=(0,r.useRef)({width:0,height:0,top:0,left:0}),{nonce:o}=(0,r.useContext)(n.MotionConfigContext);return(0,r.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:n}=i.current;if(s||!a.current||!e||!t)return;a.current.dataset.motionPopId=l;let c=document.createElement("style");return o&&(c.nonce=o),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${l}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            top: ${r}px !important;
            left: ${n}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[s]),(0,t.jsx)(c,{isPresent:s,childRef:a,sizeRef:i,children:r.cloneElement(e,{ref:a})})}let d=({children:e,initial:l,isPresent:r,onExitComplete:n,custom:c,presenceAffectsLayout:d,mode:m})=>{let h=(0,a.useConstant)(u),x=(0,s.useId)(),p=(0,s.useCallback)(e=>{for(let t of(h.set(e,!0),h.values()))if(!t)return;n&&n()},[h,n]),f=(0,s.useMemo)(()=>({id:x,initial:l,isPresent:r,custom:c,onExitComplete:p,register:e=>(h.set(e,!1),()=>h.delete(e))}),d?[Math.random(),p]:[r,p]);return(0,s.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[r]),s.useEffect(()=>{r||h.size||!n||n()},[r]),"popLayout"===m&&(e=(0,t.jsx)(o,{isPresent:r,children:e})),(0,t.jsx)(i.PresenceContext.Provider,{value:f,children:e})};function u(){return new Map}var m=e.i(71714);let h=e=>e.key||"";function x(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}var p=e.i(21753);let f=({children:e,custom:i,initial:r=!0,onExitComplete:n,presenceAffectsLayout:c=!0,mode:o="sync",propagate:u=!1})=>{let[f,y]=(0,m.usePresence)(u),g=(0,s.useMemo)(()=>x(e),[e]),b=u&&!f?[]:g.map(h),j=(0,s.useRef)(!0),v=(0,s.useRef)(g),w=(0,a.useConstant)(()=>new Map),[N,k]=(0,s.useState)(g),[E,C]=(0,s.useState)(g);(0,p.useIsomorphicLayoutEffect)(()=>{j.current=!1,v.current=g;for(let e=0;e<E.length;e++){let t=h(E[e]);b.includes(t)?w.delete(t):!0!==w.get(t)&&w.set(t,!1)}},[E,b.length,b.join("-")]);let P=[];if(g!==N){let e=[...g];for(let t=0;t<E.length;t++){let s=E[t],l=h(s);b.includes(l)||(e.splice(t,0,s),P.push(s))}"wait"===o&&P.length&&(e=P),C(x(e)),k(g);return}let{forceRender:M}=(0,s.useContext)(l.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:E.map(e=>{let s=h(e),l=(!u||!!f)&&(g===E||b.includes(s));return(0,t.jsx)(d,{isPresent:l,initial:(!j.current||!!r)&&void 0,custom:l?void 0:i,presenceAffectsLayout:c,mode:o,onExitComplete:l?void 0:()=>{if(!w.has(s))return;w.set(s,!0);let e=!0;w.forEach(t=>{t||(e=!1)}),e&&(null==M||M(),C(v.current),u&&(null==y||y()),n&&n())},children:e},s)})})};e.s(["AnimatePresence",()=>f],94556)},85242,e=>{"use strict";let t=(0,e.i(27162).default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);e.s(["Sparkles",()=>t],85242)},24448,e=>{"use strict";var t=e.i(70395),s=e.i(7951),l=e.i(37779),a=e.i(94556),i=e.i(27162);let r=(0,i.default)("shopping-bag",[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]]);var n=e.i(85242),c=e.i(6004),o=e.i(89862),d=e.i(37978);let u=(0,i.default)("wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);var m=e.i(25664),h=e.i(50339);e.i(85670);var x=e.i(25681),p=e.i(55541);function f(){let{user:e}=(0,p.useAuth)(),[i,f]=(0,s.useState)([]),[y,g]=(0,s.useState)(null),[b,j]=(0,s.useState)(!0),[v,w]=(0,s.useState)(null),[N,k]=(0,s.useState)(!1),[E,C]=(0,s.useState)("idle");(0,s.useEffect)(()=>{if(!e)return;let t=(0,x.onSnapshot)((0,x.doc)(h.db,"users",e.uid),e=>{e.exists()&&g(e.data())});return()=>t()},[e]),(0,s.useEffect)(()=>{let e=(0,x.onSnapshot)((0,x.doc)(h.db,"system_data","shop"),e=>{e.exists()&&f((e.data().items||[]).map((e,t)=>({id:t,name:e["Item Name"]||e.Name||e.Item||"Mystery Item",price:Number((e.Price||e.Cost||"0").replace(/[^0-9.]/g,"")),currency:(e.Price||"").includes("EXP")?"EXP":"THB",image:e.Image||e.Img||"ðŸŽ",type:e.Type||"General",desc:e.Description||e.Desc||""}))),j(!1)});return()=>e()},[]);let P=async()=>{if(v&&e){k(!0);try{await (0,x.addDoc)((0,x.collection)(h.db,"shop_requests"),{uid:e.uid,userEmail:e.email,userName:y?.displayName||e.displayName,userPhone:y?.phone||"",itemName:v.name,price:v.price,currency:v.currency,status:"pending",timestamp:(0,x.serverTimestamp)()}),C("success"),setTimeout(()=>{w(null),C("idle")},2e3)}catch(e){console.error(e),C("error")}finally{k(!1)}}};return(0,t.jsxs)("div",{className:"min-h-screen bg-[#F0F2F5] pb-24 font-poppins",children:[(0,t.jsxs)("div",{className:"bg-[#B0F2C2] p-6 pb-12 rounded-b-[3rem] relative overflow-hidden shadow-lg sticky top-0 z-10",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/20 rounded-full blur-2xl"}),(0,t.jsxs)("h1",{className:"text-2xl font-black text-[#1F2E4A] mb-2 flex items-center gap-2 relative z-10",children:[(0,t.jsx)(r,{className:"w-6 h-6 text-green-700"}),"ITEM SHOP"]}),y&&(0,t.jsxs)("div",{className:"bg-white/40 backdrop-blur-md inline-flex items-center gap-2 px-4 py-1.5 rounded-full text-[#1F2E4A] text-xs font-bold border border-white/50 relative z-10 shadow-sm animate-in fade-in slide-in-from-bottom-2",children:[(0,t.jsx)(u,{className:"w-3.5 h-3.5"}),(0,t.jsxs)("span",{children:["My Balance: ",y.exp?.toLocaleString()||0," EXP"]})]})]}),(0,t.jsx)("div",{className:"px-5 -mt-6 relative z-20",children:b?(0,t.jsx)("div",{className:"flex justify-center pt-10",children:(0,t.jsx)(c.Loader2,{className:"w-8 h-8 animate-spin text-green-500"})}):0===i.length?(0,t.jsxs)("div",{className:"text-center py-10 text-slate-400",children:[(0,t.jsx)(r,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"Shop is currently closed."})]}):(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:i.map((e,s)=>(0,t.jsxs)(l.motion.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},onClick:()=>w(e),className:"bg-white p-4 rounded-3xl shadow-sm border border-gray-100 flex flex-col items-center relative overflow-hidden group hover:shadow-md transition-shadow text-left w-full",children:[(0,t.jsx)("div",{className:"absolute top-2 right-2 p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(n.Sparkles,{className:"w-4 h-4 text-yellow-400"})}),(0,t.jsx)("div",{className:"w-20 h-20 bg-gray-50 rounded-2xl flex items-center justify-center text-4xl mb-3 shadow-inner",children:e.image.includes("http")?(0,t.jsx)("img",{src:e.image,className:"w-full h-full object-cover rounded-2xl"}):e.image}),(0,t.jsx)("h3",{className:"font-bold text-[#1F2E4A] text-xs text-center mb-1 line-clamp-2 min-h-[2.5em]",children:e.name}),e.desc&&(0,t.jsx)("p",{className:"text-[10px] text-gray-400 text-center mb-2 line-clamp-1",children:e.desc}),(0,t.jsx)("div",{className:"mt-auto w-full pt-2",children:(0,t.jsxs)("div",{className:"w-full py-2.5 bg-[#1F2E4A] text-white text-xs font-bold rounded-xl active:scale-95 transition-transform flex items-center justify-center gap-1 hover:bg-[#2a3b5e]",children:["EXP"===e.currency?"ðŸª™":"à¸¿"," ",e.price.toLocaleString()]})})]},s))})}),(0,t.jsx)(a.AnimatePresence,{children:v&&(0,t.jsx)(l.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:(0,t.jsx)(l.motion.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-white w-full max-w-sm rounded-[2rem] p-6 shadow-2xl relative overflow-hidden",children:"success"===E?(0,t.jsxs)("div",{className:"flex flex-col items-center py-6 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4 text-green-500",children:(0,t.jsx)(d.CheckCircle2,{className:"w-8 h-8"})}),(0,t.jsx)("h3",{className:"text-xl font-black text-[#1F2E4A] mb-2",children:"Request Sent!"}),(0,t.jsx)("p",{className:"text-gray-500 text-xs",children:"Admin will process your order shortly."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>w(null),className:"absolute top-4 right-4 text-gray-300 hover:text-gray-600 p-2",children:(0,t.jsx)(m.X,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsx)("div",{className:"w-24 h-24 bg-gray-50 rounded-2xl mx-auto flex items-center justify-center text-5xl shadow-inner mb-4 border border-gray-100",children:v.image.includes("http")?(0,t.jsx)("img",{src:v.image,className:"w-full h-full object-cover rounded-2xl"}):v.image}),(0,t.jsx)("h3",{className:"text-lg font-black text-[#1F2E4A] mb-1",children:v.name}),(0,t.jsxs)("div",{className:"inline-flex items-center gap-1 bg-[#1F2E4A] text-white px-3 py-1 rounded-lg text-xs font-bold",children:["EXP"===v.currency?"ðŸª™":"à¸¿"," ",v.price.toLocaleString()]})]}),"EXP"===v.currency&&y&&y.exp<v.price&&(0,t.jsxs)("div",{className:"bg-red-50 text-red-500 text-xs p-3 rounded-xl mb-4 flex items-center gap-2 font-bold",children:[(0,t.jsx)(o.AlertCircle,{className:"w-4 h-4 shrink-0"}),"Not enough EXP! (",y.exp,")"]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("p",{className:"text-center text-[10px] text-gray-400",children:"By confirming, a purchase request will be sent to the Admin."}),(0,t.jsxs)("button",{disabled:N||"EXP"===v.currency&&y?.exp<v.price,onClick:P,className:"w-full py-3.5 bg-green-500 hover:bg-green-600 text-white font-bold rounded-xl shadow-lg shadow-green-200 transition-all disabled:opacity-50 disabled:shadow-none flex items-center justify-center gap-2",children:[N?(0,t.jsx)(c.Loader2,{className:"w-5 h-5 animate-spin"}):(0,t.jsx)(r,{className:"w-5 h-5"}),"Confirm Purchase"]})]})]})})})})]})}e.s(["default",()=>f],24448)}]);