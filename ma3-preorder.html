<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üéâ ‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå MA3 & Midnight Party - Up Level Academy</title>
  
  <!-- Add Google Font 'Kanit' -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700&display=swap" rel="stylesheet">
  
  <style>
    body {
      font-family: 'Kanit', 'Segoe UI', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', sans-serif;
      background: linear-gradient(135deg, #1a0f00 0%, #2d1a00 25%, #3d2500 50%, #2d1a00 75%, #1a0f00 100%);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      margin: 0;
      padding: 1rem;
      text-align: center;
      min-height: 100vh;
      color: #fff;
      position: relative;
      overflow-x: hidden;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    /* Card pack near logo - cute shake animation */
    .floating-card-pack {
      position: absolute;
      width: 80px;
      height: auto;
      z-index: 5;
      pointer-events: none;
      opacity: 0.9;
      animation: cuteShake 2s ease-in-out infinite;
    }

    .floating-card-pack:nth-child(1) {
      top: 20px;
      right: 20px;
      animation-delay: 0s;
    }

    .floating-card-pack:nth-child(2) {
      top: 20px;
      left: 20px;
      animation-delay: 0.3s;
    }

    .floating-card-pack:nth-child(3),
    .floating-card-pack:nth-child(4) {
      display: none;
    }

    @keyframes cuteShake {
      0%, 100% {
        transform: translate(0, 0) rotate(0deg) scale(1);
      }
      10% {
        transform: translate(-3px, -2px) rotate(-3deg) scale(1.05);
      }
      20% {
        transform: translate(3px, 2px) rotate(3deg) scale(1.02);
      }
      30% {
        transform: translate(-2px, 3px) rotate(-2deg) scale(1.03);
      }
      40% {
        transform: translate(2px, -3px) rotate(2deg) scale(1.04);
      }
      50% {
        transform: translate(-1px, -1px) rotate(-1deg) scale(1.05);
      }
      60% {
        transform: translate(1px, 2px) rotate(1deg) scale(1.03);
      }
      70% {
        transform: translate(-2px, 1px) rotate(-2deg) scale(1.04);
      }
      80% {
        transform: translate(2px, -2px) rotate(2deg) scale(1.02);
      }
      90% {
        transform: translate(-1px, 1px) rotate(-1deg) scale(1.03);
      }
    }

    /* Responsive for mobile - smaller cards */
    @media (max-width: 768px) {
      .floating-card-pack {
        width: 60px;
        opacity: 0.85;
      }

      .floating-card-pack:nth-child(1) {
        top: 10px;
        right: 10px;
      }

      .floating-card-pack:nth-child(2) {
        top: 10px;
        left: 10px;
      }

      .floating-card-pack:nth-child(3),
      .floating-card-pack:nth-child(4) {
        display: none;
      }
    }

    .container {
      max-width: 900px;
      margin: auto;
      background: linear-gradient(135deg, rgba(30, 20, 5, 0.85) 0%, rgba(40, 25, 10, 0.85) 100%);
      border-radius: 25px;
      padding: 2rem;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4), 0 0 100px rgba(255, 215, 0, 0.2);
      backdrop-filter: blur(20px);
      border: 2px solid rgba(255, 215, 0, 0.4);
      position: relative;
      z-index: 10;
    }

    .home-button {
      position: fixed;
      top: 20px;
      left: 20px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 50%;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
    }

    .home-button:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
      background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
    }

    .home-button::before {
      content: "üè†";
      font-size: 24px;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }

    .header {
      text-align: center;
      margin-bottom: 2rem;
      position: relative;
    }

    .logo {
      width: 120px;
      margin-bottom: 1rem;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
    }

    .event-title {
      font-size: 3rem;
      font-weight: 700;
      background: linear-gradient(45deg, #ffd700, #ffed4e, #ffaa00, #ffd700);
      background-size: 300% 300%;
      animation: gradientFlow 3s ease infinite, glow 2s ease-in-out infinite alternate;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      margin-bottom: 0.5rem;
      filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.8));
    }

    @keyframes gradientFlow {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    @keyframes glow {
      from { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.8)); }
      to { filter: drop-shadow(0 0 25px rgba(255, 200, 0, 1)); }
    }

    .event-subtitle {
      font-size: 1.3rem;
      color: #ffd700;
      margin-bottom: 1rem;
      font-weight: 600;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
      animation: subtitlePulse 2s ease-in-out infinite;
    }

    @keyframes subtitlePulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }

    .event-date {
      font-size: 1.5rem;
      color: #ffd700;
      margin-bottom: 2rem;
      font-weight: 700;
      text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
    }

    .product-showcase {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
      border-radius: 20px;
      padding: 6px;
      margin: 2rem 0;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .product-title {
      font-size: 1.8rem;
      color: #ffd700;
      margin-bottom: 1rem;
      font-weight: 700;
      text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
      animation: titleShimmer 3s ease-in-out infinite;
    }

    @keyframes titleShimmer {
      0%, 100% { text-shadow: 0 0 15px rgba(255, 215, 0, 0.8); }
      50% { text-shadow: 0 0 25px rgba(255, 200, 0, 1), 0 0 35px rgba(255, 180, 0, 0.7); }
    }

    .product-description {
      font-size: 1.1rem;
      color: #e0e0e0;
      margin-bottom: 1.5rem;
      line-height: 1.6;
    }

    .pricing-section {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin: 1.5rem 0;
      align-items: center;
    }

    .pricing-card {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
      border-radius: 15px;
      padding: 1rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
      width: 100%;
      max-width: 350px;
    }

    .pricing-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      border-color: rgba(255, 217, 61, 0.5);
    }

    .promo-campaign-section {
      background: linear-gradient(135deg, rgba(255, 217, 61, 0.15) 0%, rgba(255, 193, 7, 0.1) 100%);
      border-radius: 20px;
      padding: 1.5rem;
      margin: 2rem 0;
      border: 2px solid rgba(255, 217, 61, 0.4);
      box-shadow: 0 0 20px rgba(255, 217, 61, 0.2);
    }

    .promo-campaign-title {
      font-size: 1.8rem;
      color: #ffd93d;
      margin-bottom: 1rem;
      font-weight: 700;
      text-shadow: 0 0 15px rgba(255, 217, 61, 0.6);
      animation: titleShimmer 3s ease-in-out infinite;
    }

    .promo-campaign-description {
      font-size: 1.1rem;
      color: #e0e0e0;
      margin-bottom: 1.5rem;
      line-height: 1.6;
    }

    .promo-cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin-top: 1.5rem;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
      justify-items: center;
    }

    .promo-card-item {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 0.8rem;
      border: 2px solid rgba(255, 217, 61, 0.3);
      transition: all 0.3s ease;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .promo-card-item:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 10px 25px rgba(255, 217, 61, 0.4);
      border-color: rgba(255, 217, 61, 0.6);
    }

    .promo-card-item img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      display: block;
      margin: 0 auto;
    }

    .promo-card-modal {
      display: none;
      position: fixed;
      z-index: 10000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
    }

    .promo-card-modal-content {
      position: relative;
      margin: auto;
      padding: 20px;
      max-width: 90%;
      max-height: 90vh;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
    }

    .promo-card-modal-image {
      max-width: 100%;
      max-height: 90vh;
      border-radius: 12px;
      box-shadow: 0 0 50px rgba(255, 217, 61, 0.5);
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 40px;
      color: #fff;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10001;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-close:hover {
      background: rgba(255, 107, 107, 0.8);
      transform: rotate(90deg);
    }

    .user-promo-cards {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      justify-content: center;
      margin-top: 0.5rem;
    }

    .user-promo-card-mini {
      width: 40px;
      height: auto;
      border-radius: 4px;
      border: 1px solid rgba(255, 217, 61, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .user-promo-card-mini:hover {
      transform: scale(1.2);
      border-color: #ffd93d;
      box-shadow: 0 0 10px rgba(255, 217, 61, 0.6);
    }

    .pricing-title {
      font-size: 1.4rem;
      color: #ffd93d;
      margin-bottom: 1rem;
      font-weight: 700;
    }

    .price {
      font-size: 2rem;
      color: #6bcf7f;
      margin-bottom: 1rem;
      font-weight: 700;
    }

    .price-note {
      font-size: 0.9rem;
      color: #b0b0b0;
      margin-bottom: 1rem;
    }

    .benefits {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .benefits li {
      background: rgba(255, 255, 255, 0.05);
      margin-bottom: 0.5rem;
      padding: 0.5rem;
      border-radius: 8px;
      color: #e0e0e0;
      font-size: 0.9rem;
    }

    .spot-info {
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.1) 0%, rgba(255, 107, 107, 0.05) 100%);
      border-radius: 20px;
      padding: 1.5rem;
      margin: 2rem 0;
      border: 1px solid rgba(255, 107, 107, 0.3);
    }

    .spot-title {
      font-size: 1.6rem;
      color: #ff6b6b;
      margin-bottom: 1rem;
      font-weight: 700;
    }

    .spot-description {
      font-size: 1.1rem;
      color: #e0e0e0;
      margin-bottom: 1rem;
      line-height: 1.6;
    }

    .bonus-section {
      background: linear-gradient(135deg, rgba(107, 207, 127, 0.1) 0%, rgba(107, 207, 127, 0.05) 100%);
      border-radius: 20px;
      padding: 1.5rem;
      margin: 2rem 0;
      border: 1px solid rgba(107, 207, 127, 0.3);
    }

    .bonus-title {
      font-size: 1.6rem;
      color: #6bcf7f;
      margin-bottom: 1rem;
      font-weight: 700;
    }

    .bonus-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .bonus-list li {
      background: rgba(255, 255, 255, 0.05);
      margin-bottom: 0.8rem;
      padding: 0.8rem;
      border-radius: 10px;
      color: #e0e0e0;
      font-size: 1rem;
      border-left: 4px solid #6bcf7f;
    }

    .important-notes {
      background: linear-gradient(135deg, rgba(255, 217, 61, 0.1) 0%, rgba(255, 217, 61, 0.05) 100%);
      border-radius: 20px;
      padding: 1.5rem;
      margin: 2rem 0;
      border: 1px solid rgba(255, 217, 61, 0.3);
    }

    .notes-title {
      font-size: 1.6rem;
      color: #ffd93d;
      margin-bottom: 1rem;
      font-weight: 700;
    }

    .notes-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .notes-list li {
      background: rgba(255, 255, 255, 0.05);
      margin-bottom: 0.8rem;
      padding: 0.8rem;
      border-radius: 10px;
      color: #e0e0e0;
      font-size: 1rem;
      border-left: 4px solid #ffd93d;
    }

    .cta-section {
      text-align: center;
      margin: 3rem 0;
    }

    .cta-button {
      display: inline-block;
      background: linear-gradient(45deg, #ffd700, #ffed4e, #ffaa00);
      background-size: 200% 200%;
      animation: buttonGradient 3s ease infinite;
      color: #1a0f00;
      padding: 1.5rem 3rem;
      border-radius: 50px;
      text-decoration: none;
      font-size: 1.3rem;
      font-weight: 700;
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.6), 0 0 40px rgba(255, 200, 0, 0.4);
      transition: all 0.3s ease;
      border: 2px solid rgba(255, 215, 0, 0.6);
      cursor: pointer;
    }

    @keyframes buttonGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .cta-button:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 15px 40px rgba(255, 215, 0, 0.8), 0 0 60px rgba(255, 200, 0, 0.6);
      border-color: rgba(255, 215, 0, 0.9);
    }

    .cta-top {
      text-align: center;
      margin: 2rem 0;
    }

    .cta-button-top {
      display: inline-block;
      background: linear-gradient(45deg, #ffd700, #ffed4e, #ffaa00);
      background-size: 200% 200%;
      animation: buttonGradient 3s ease infinite;
      color: #1a0f00;
      padding: 1rem 2.5rem;
      border-radius: 50px;
      text-decoration: none;
      font-size: 1.1rem;
      font-weight: 700;
      box-shadow: 0 8px 25px rgba(255, 215, 0, 0.6), 0 0 30px rgba(255, 200, 0, 0.4);
      transition: all 0.3s ease;
      border: 2px solid rgba(255, 215, 0, 0.6);
      cursor: pointer;
    }

    .cta-button-top:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 12px 30px rgba(255, 215, 0, 0.8), 0 0 50px rgba(255, 200, 0, 0.6);
      border-color: rgba(255, 215, 0, 0.9);
    }

    .guild-button {
      display: inline-block;
      background: linear-gradient(45deg, #ffaa00, #ff9500);
      color: #fff;
      padding: 0.8rem 2rem;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 700;
      font-size: 0.9rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(255, 200, 0, 0.5), 0 0 20px rgba(255, 180, 0, 0.3);
      border: 1px solid rgba(255, 215, 0, 0.4);
      cursor: pointer;
      margin-top: 1rem;
    }

    .guild-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(255, 200, 0, 0.7), 0 0 40px rgba(255, 215, 0, 0.5);
      background: linear-gradient(45deg, #ffd700, #ffaa00);
    }

    .info-section {
      background: transparent;
      border-radius: 20px;
      padding: 1.5rem;
      margin: 2rem 0;
      border: none;
    }

    .info-title {
      font-size: 1.6rem;
      color: #ffd700;
      margin-bottom: 1.5rem;
      font-weight: 700;
      text-align: center;
      text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
      animation: titleShimmer 3s ease-in-out infinite;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .info-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 1.2rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
    }

    .info-card:hover {
      transform: translateY(-3px);
      background: rgba(255, 255, 255, 0.08);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    }

    .info-card.bonus {
      border-color: rgba(107, 207, 127, 0.3);
    }

    .info-card.notes {
      border-color: rgba(255, 217, 61, 0.3);
    }

    .info-card h4 {
      color: #ffd93d;
      font-size: 1.3rem;
      margin-bottom: 1rem;
      font-weight: 700;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    .info-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .info-list li {
      background: rgba(255, 255, 255, 0.05);
      margin-bottom: 0.8rem;
      padding: 0.8rem;
      border-radius: 10px;
      color: #e0e0e0;
      font-size: 1rem;
      border-left: 4px solid #6bcf7f;
    }

    .info-card.notes .info-list li {
      border-left-color: #ffd93d;
    }

    .footer {
      margin-top: 3rem;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .footer-title {
      font-size: 1.4rem;
      color: #ffd700;
      margin-bottom: 1rem;
      font-weight: 700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
    }

    .contact-info {
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
      margin-top: 1rem;
    }

    .contact-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: #e0e0e0;
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .contact-item:hover {
      color: #ffd700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
    }

    /* ‡πÄ‡∏û‡∏¥‡πà‡∏° CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ */
    .registered-users-section {
      background: linear-gradient(135deg, rgba(107, 207, 127, 0.1) 0%, rgba(107, 207, 127, 0.05) 100%);
      border-radius: 20px;
      padding: 2rem;
      margin: 2rem 0;
      border: 1px solid rgba(107, 207, 127, 0.3);
    }

    .users-title {
      font-size: 1.8rem;
      color: #ffd700;
      margin-bottom: 1.5rem;
      font-weight: 700;
      text-align: center;
      text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      animation: titleShimmer 3s ease-in-out infinite;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.8rem;
      margin-bottom: 2rem;
      max-width: 100%;
      justify-content: center;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 0.8rem;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
      min-width: 0;
      overflow: hidden;
    }

    .stat-number {
      font-size: 2rem;
      color: #ffd700;
      font-weight: 700;
      margin-bottom: 0.5rem;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
      animation: numberPulse 2s ease-in-out infinite;
    }

    @keyframes numberPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .stat-label {
      color: #e0e0e0;
      font-size: 0.8rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 1.2;
    }

    .users-list {
      max-height: 400px;
      overflow-y: auto;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 1rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .refresh-button {
      background: linear-gradient(45deg, #ffd700, #ffaa00);
      color: #1a0f00;
      padding: 0.8rem 1.5rem;
      border-radius: 25px;
      border: 1px solid rgba(255, 215, 0, 0.4);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 1rem;
      box-shadow: 0 4px 15px rgba(255, 215, 0, 0.5), 0 0 20px rgba(255, 200, 0, 0.3);
    }

    .refresh-button:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 8px 20px rgba(255, 215, 0, 0.7), 0 0 30px rgba(255, 200, 0, 0.5);
      border-color: rgba(255, 215, 0, 0.7);
    }

    .loading {
      text-align: center;
      color: #ffd700;
      font-size: 1.1rem;
      padding: 2rem;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
    }

    /* Loading spinner */
    .spinner {
      margin: 24px auto 8px auto;
      border: 6px solid #e0e0e0;
      border-top: 6px solid #ffd700;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg);}
      100% { transform: rotate(360deg);}
    }

    .error-message {
      background: rgba(255, 107, 107, 0.1);
      border: 1px solid rgba(255, 107, 107, 0.3);
      border-radius: 10px;
      padding: 1rem;
      color: #ff6b6b;
      text-align: center;
      margin: 1rem 0;
    }

    /* Codename ‡∏™‡∏µ/‡∏Ç‡∏ô‡∏≤‡∏î/‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡∏ï‡∏≤‡∏° rank */
    .codename-rank[data-rank="Rookie"]      .codename { color: #888888; font-size: 1.05em; }
    .codename-rank[data-rank="Bronze"]      .codename { color: #b87333; font-size: 1.08em; }
    .codename-rank[data-rank="Silver"]      .codename { color: #9e9e9e; font-size: 1.12em; }
    .codename-rank[data-rank="Gold"]        .codename { color: #ffd700; font-size: 1.18em; font-weight: bold; }
    .codename-rank[data-rank="Platinum"]    .codename { color: #00bcd4; font-size: 1.22em; font-weight: bold; }
    .codename-rank[data-rank="Diamond"]     .codename { color: #ffd700; font-size: 1.28em; font-weight: bold; }
    .codename-rank[data-rank="Grandmaster"] .codename { color: #8e24aa; font-size: 1.35em; font-weight: bold; }
    .codename-rank[data-rank="Legend"]      .codename { color: #e53935; font-size: 1.45em; font-weight: bold; }
    .codename-rank[data-rank="Gold"]        .codename,
    .codename-rank[data-rank="Platinum"]    .codename,
    .codename-rank[data-rank="Diamond"]     .codename,
    .codename-rank[data-rank="Grandmaster"] .codename,
    .codename-rank[data-rank="Legend"]      .codename {
      animation: blink 1s step-end infinite alternate;
    }
    @keyframes blink {
      0%   { opacity: 1;   text-shadow: 0 0 8px #fff, 0 0 16px currentColor; }
      100% { opacity: 0.6; text-shadow: 0 0 2px #fff, 0 0 4px currentColor; }
    }
    /* Wave (Gold) */
    @keyframes wave {
      0%, 100% { transform: translateY(0);}
      20%      { transform: translateY(-5px);}
      40%      { transform: translateY(-10px);}
      60%      { transform: translateY(-5px);}
      80%      { transform: translateY(0);}
    }
    .codename.wave span {
      display: inline-block;
      animation: wave 1.2s cubic-bezier(0.4,0,0.2,1) infinite;
    }
    .codename.wave.gold span { animation-duration: 1.2s; }
    .codename.wave.platinum span { animation-duration: 1s; }
    .codename.wave.diamond span { animation-duration: 0.85s; }
    .codename.wave.grandmaster span { animation-duration: 0.7s; }
    .codename.wave.legend span { animation-duration: 0.6s; }
    .codename.wave span:nth-child(1) { animation-delay: 0s; }
    .codename.wave span:nth-child(2) { animation-delay: 0.08s; }
    .codename.wave span:nth-child(3) { animation-delay: 0.16s; }
    .codename.wave span:nth-child(4) { animation-delay: 0.24s; }
    .codename.wave span:nth-child(5) { animation-delay: 0.32s; }
    .codename.wave span:nth-child(6) { animation-delay: 0.40s; }
    .codename.wave span:nth-child(7) { animation-delay: 0.48s; }
    .codename.wave span:nth-child(8) { animation-delay: 0.56s; }
    .codename.wave span:nth-child(9) { animation-delay: 0.64s; }
    .codename.wave span:nth-child(10){ animation-delay: 0.72s; }

    /* Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 1rem;
        margin: 0.5rem;
      }
      
      .event-title {
        font-size: 2rem;
      }
      
      .event-subtitle {
        font-size: 1.1rem;
      }
      
      .event-date {
        font-size: 1.2rem;
      }
      
      .pricing-section {
        grid-template-columns: 1fr;
      }
      
      .contact-info {
        flex-direction: column;
        gap: 1rem;
      }
      
      .home-button {
        top: 15px;
        left: 15px;
        width: 50px;
        height: 50px;
      }
      
      .home-button::before {
        font-size: 20px;
      }
      
      .stats-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 0.6rem;
        padding: 0 0.5rem;
      }
      
      .stat-card {
        padding: 0.6rem 0.4rem;
      }
      
      .stat-number {
        font-size: 1.5rem;
      }
      
      .stat-label {
        font-size: 0.7rem;
        line-height: 1.1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      
      .info-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      .users-title {
        font-size: 1.4rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .promo-cards-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.8rem;
      }

      .promo-campaign-title {
        font-size: 1.4rem;
      }

      .promo-campaign-description {
        font-size: 1rem;
      }
    }
    
    @media (max-width: 480px) {
      .container {
        padding: 0.8rem;
        margin: 0.3rem;
      }
      
      .event-title {
        font-size: 1.8rem;
      }
      
      .event-subtitle {
        font-size: 1rem;
      }
      
      .event-date {
        font-size: 1.1rem;
      }
      
      .users-title {
        font-size: 1.2rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      
      .stats-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 0.4rem;
        padding: 0 0.3rem;
      }
      
      .stat-card {
        padding: 0.5rem 0.3rem;
      }
      
      .stat-number {
        font-size: 1.3rem;
      }
      
      .stat-label {
        font-size: 0.65rem;
        line-height: 1.1;
      }

      .promo-cards-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.6rem;
      }

      .promo-campaign-title {
        font-size: 1.2rem;
      }

      .promo-campaign-description {
        font-size: 0.9rem;
      }

      .user-promo-card-mini {
        width: 35px;
      }
    }
  </style>
</head>
<body>
  <a href="index.html" class="home-button" title="‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å"></a>

  <div class="container">
    <!-- Card packs near logo - cute shake animation -->
    <!-- ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏ã‡∏≠‡∏á MA3 ‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡πâ‡∏°‡∏≤ - ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï URL ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ -->
    <img src="https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_ma3_pkg.png" alt="MA3 Booster Pack" class="floating-card-pack" onerror="this.src='https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/09/th_news_MA2_pillow_img-1.png'">
    <img src="https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_ma3_pkg.png" alt="MA3 Booster Pack" class="floating-card-pack" onerror="this.src='https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/09/th_news_MA2_pillow_img-1.png'">
    
    <div class="header">
      <img src="https://i.postimg.cc/wjzpnxjB/Up-Level-01-1.png" alt="Up Level Academy Logo" class="logo">
      <h1 class="event-title">üéâ ‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå Booster Box MA3 & ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô Midnight Party üéâ</h1>
      <div class="event-subtitle">‡∏ß‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏Å‡πâ‡∏≤ ‡∏î‡∏£‡∏µ‡∏°ex</div>
      <div class="product-description" style="text-align: center; margin-top: 1rem; font-size: 1.2rem;">
        ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏ö‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ä‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‚Äú‡∏ß‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏Å‡πâ‡∏≤‡∏î‡∏£‡∏µ‡∏° (MA3)‚Äù<br>
        <strong>‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‚Äî ‡∏ó‡∏±‡πâ‡∏á ‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</strong>
      </div>
      
      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô -->
      <div class="cta-top">
        <a href="https://forms.gle/3xZG8VewZjJtepQN6" target="_blank" class="cta-button-top">
          üéØ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
        </a>
      </div>
    </div>

    <div class="product-showcase">
      <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (‡∏¢‡πâ‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á section) -->
      <div class="registered-users-section" style="margin-top: 0;">
        <h3 class="users-title">üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
        
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="totalUsers">-</div>
            <div class="stat-label">‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalBoxes">-</div>
            <div class="stat-label">Box ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
          </div>
        </div>
        
        <button class="refresh-button" onclick="loadRegisteredUsers()">
          üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        </button>
        
        <div id="usersContainer">
          <div class="spinner"></div>
          <div class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
        </div>
      </div>
    </div>

    <div class="pricing-section">
      <div class="pricing-card" style="border-color: #4facfe; box-shadow: 0 0 15px rgba(79, 172, 254, 0.3);">
        <h3 class="pricing-title" style="color: #4facfe;">üîµ ‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ MA3</h3>
        <div class="price">üí∏ Booster Box 1,550 ‡∏ö‡∏≤‡∏ó / Box</div>
        <div class="price-note">‚ú® ‡∏ã‡∏∑‡πâ‡∏≠ 2 Box ‡∏£‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÇ‡∏° 1 ‡∏ã‡∏≠‡∏á</div>
        <ul class="benefits">
          <li>‚úÖ ‡∏£‡∏±‡∏ö 5 EXP ‡∏ï‡πà‡∏≠ 1 Box (‡∏õ‡∏Å‡∏ï‡∏¥)</li>
          <li>‚úÖ ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 16 ‡∏°.‡∏Ñ. 2026 ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏õ</li>
        </ul>
      </div>
    </div>

    <div class="promo-campaign-section">
      <h3 class="promo-campaign-title">üéÅ ‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏û‡∏¥‡πÄ‡∏®‡∏©: ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏° MA3</h3>
      <div class="promo-campaign-description">
        <strong>‚ú® ‡∏ã‡∏∑‡πâ‡∏≠ Booster Box 2 ‡∏Å‡∏•‡πà‡∏≠‡∏á ‚Üí ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏° 1 ‡∏ã‡∏≠‡∏á ‚ú®</strong><br><br>
        ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ã‡∏≠‡∏á‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏∏‡πà‡∏° 1 ‡πÉ‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 4 ‡πÅ‡∏ö‡∏ö<br>
        ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
      </div>
      <div class="promo-cards-grid">
        <div class="promo-card-item" onclick="openPromoCardModal('https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_MPromo_047.png')">
          <img src="https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_MPromo_047.png" alt="Promo Card 047" loading="lazy">
        </div>
        <div class="promo-card-item" onclick="openPromoCardModal('https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_MPromo_048.png')">
          <img src="https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_MPromo_048.png" alt="Promo Card 048" loading="lazy">
        </div>
        <div class="promo-card-item" onclick="openPromoCardModal('https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_MPromo_049.png')">
          <img src="https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_MPromo_049.png" alt="Promo Card 049" loading="lazy">
        </div>
        <div class="promo-card-item" onclick="openPromoCardModal('https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_MPromo_050.png')">
          <img src="https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_MPromo_050.png" alt="Promo Card 050" loading="lazy">
        </div>
      </div>
    </div>

    <!-- Modal for viewing promo cards -->
    <div id="promoCardModal" class="promo-card-modal">
      <span class="modal-close" onclick="closePromoCardModal()">&times;</span>
      <div class="promo-card-modal-content">
        <img id="promoCardModalImage" class="promo-card-modal-image" src="" alt="Promo Card">
      </div>
    </div>

    <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏à‡∏≤‡∏Å‡∏ä‡∏∏‡∏î MA3 -->
    <div class="promo-campaign-section" style="margin-top: 2rem;">
      <h3 class="promo-campaign-title">üåü ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏à‡∏≤‡∏Å‡∏ä‡∏∏‡∏î MA3</h3>
      <div class="promo-campaign-description">
        ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏Å‡∏£‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡πÇ‡∏ä‡∏ß‡πå‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡πÅ‡∏Ç‡πà‡∏á‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏±‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á!
      </div>
      <div class="promo-cards-grid">
        <div class="promo-card-item" onclick="openPromoCardModal('https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_ma3_card_223-1.png')">
          <img src="https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_ma3_card_223-1.png" alt="MA3 Card 223" loading="lazy">
        </div>
        <div class="promo-card-item" onclick="openPromoCardModal('https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_ma3_card_228-1.png')">
          <img src="https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_ma3_card_228-1.png" alt="MA3 Card 228" loading="lazy">
        </div>
        <div class="promo-card-item" onclick="openPromoCardModal('https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_ma3_card_226-1.png')">
          <img src="https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_ma3_card_226-1.png" alt="MA3 Card 226" loading="lazy">
        </div>
        <div class="promo-card-item" onclick="openPromoCardModal('https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_ma3_card_243.png')">
          <img src="https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_ma3_card_243.png" alt="MA3 Card 243" loading="lazy">
        </div>
      </div>
    </div>

    <div class="spot-info">
      <h3 class="spot-title">üî¥ Midnight Party</h3>
      <div class="spot-description">
        <strong>‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡πá‡∏≠‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏Ñ‡∏£‡πÉ‡∏ô‡∏á‡∏≤‡∏ô Midnight Party ‡∏Ñ‡∏∑‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 15 ‡∏°.‡∏Ñ. 2026 (‡∏Ç‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤ 16 ‡∏°.‡∏Ñ.)</strong><br><br>
        ‡∏Ñ‡∏∑‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 15 ‡∏°.‡∏Ñ. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô 23:30 ‡∏ô.<br>
        ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÑ‡∏•‡∏ü‡πå‡∏™‡∏î ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô!<br><br>
        <strong>üéÅ ‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö:</strong>
        <ul class="benefits" style="margin-top: 10px; display: inline-block;">
          <li>‚ú® +2 EXP</li>
          <li>‚ú® +2 Party Point</li>
          <li>‚ú® +6 EXP ‡∏ï‡πà‡∏≠ 1 Box</li>
          <li>‚ú® ‡∏°‡∏≤‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏≤‡∏£‡πå‡∏ï‡∏µ‡πâ ‚Üí +5 Party Point</li>
        </ul>
      </div>
    </div>

    <div class="info-section">
      <h3 class="info-title">üìã ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h3>
      <div class="info-grid">
        <div class="info-card notes" style="border-color: #ffd93d; grid-column: 1 / -1;">
          <h4>üìå ‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</h4>
          <ul class="info-list">
            <li>üìå ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡∏°‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô ‡∏¢‡∏±‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ + EXP ‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥</li>
            <li>üìå ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</li>
            <li>üìå ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</li>
            <li>üìå ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 16 ‡∏°.‡∏Ñ. 2026 ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏õ</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="cta-section">
      <a href="https://forms.gle/3xZG8VewZjJtepQN6" target="_blank" class="cta-button">
        üéØ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡∏à‡∏≠‡∏á (‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏á‡∏≤‡∏ô)
      </a>
      <a href="https://forms.gle/5ctkLmT3FwLW9oRi6" target="_blank" class="guild-button">
        üè∞ ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Å‡∏¥‡∏•‡∏î‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∞‡∏™‡∏° EXP
      </a>
    </div>

    <div class="footer">
      <h3 class="footer-title">üìç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/Midnight Party</h3>
      <p style="color: #e0e0e0; margin-bottom: 1rem;">‡∏£‡πâ‡∏≤‡∏ô Up Level Academy<br>(‡∏ï‡∏¥‡∏î MRT ‡∏ö‡∏≤‡∏á‡πÅ‡∏Ñ ‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏Å 2)</p>
      
      <h3 class="footer-title">‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h3>
      <div class="contact-info">
        <a href="tel:097-115-6555" class="contact-item">
          üìû 097-115-6555
        </a>
        <a href="https://line.me/ti/p/@uplevelacademy" target="_blank" class="contact-item">
          üí¨ @uplevelacademy
        </a>
        <a href="https://www.facebook.com/uplevel.acad" target="_blank" class="contact-item">
          üëç Up Level Academy
        </a>
        <a href="https://www.instagram.com/uplevel.acad" target="_blank" class="contact-item">
          üì∏ uplevel.acad
        </a>
      </div>
      <div style="margin-top: 1rem;">
        <a href="https://shorturl.at/8r2Aw" target="_blank" class="contact-item" style="display: inline-block;">
          üí¨ Line Open chat Pokemon
        </a>
        <a href="https://uplevelguild.netlify.app/" target="_blank" class="contact-item" style="display: inline-block;">
          üåê Up Level Guild Website
        </a>
      </div>
    </div>
  </div>

  <script>
    console.log('DEBUG: MA3 Pre-order & Midnight Party Registration System');
    
    // ‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ï‡πâ‡∏≠‡∏á Deploy App Script ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!
    // 1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Google Sheet: https://docs.google.com/spreadsheets/d/1wi2OXnelj5D61E8Jv6wBN0RwCRbsQlgiWXnfGxrjlww/edit
    // 2. ‡∏Ñ‡∏•‡∏¥‡∏Å Extensions > Apps Script
    // 3. Copy ‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå "app script MA3 Preorder" ‡πÑ‡∏õ‡∏ß‡∏≤‡∏á
    // 4. ‡∏Ñ‡∏•‡∏¥‡∏Å Deploy > New deployment > ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Type: Web app
    // 5. Execute as: Me, Who has access: Anyone
    // 6. Copy URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
    const apiUrl = "https://script.google.com/macros/s/AKfycbzjBOVrpzhWSG2PhqttAyIX9jHA1seaNrtiXD-2Zkyk1iAFxfTySAhHrQ2ElRS2aXeenQ/exec?type=json";
    const memberDashboardApi = "https://script.google.com/macros/s/AKfycbxtjsDwHI6nJU4OIHExUxMaZwUn3qwakvdkzwbQO7C8Trzz5Gh84SX6F1gqb4BOFQcn/exec?func=getMemberDashboardData";
    
    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
    window.addEventListener('load', function() {
      loadRegisteredUsers();
    });

    function loadRegisteredUsers() {
      const container = document.getElementById('usersContainer');
      container.innerHTML = '<div class="spinner"></div><div class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>';
      
      console.log('=== MA3 PRE-ORDER DEBUG: Starting loadRegisteredUsers ===');
      console.log('API URL:', apiUrl);
      console.log('Member Dashboard API URL:', memberDashboardApi);
      console.log('Timestamp:', new Date().toISOString());
      
      // ‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö midnight-party.html - fetch() ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤
      Promise.all([
        fetch(apiUrl).then(res => res.json()),
        fetch(memberDashboardApi).then(res => res.json())
      ]).then(([data, members]) => {
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ data ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        if (!data || !data.participants) {
          console.error('‚ùå No participants data received');
          showFallbackData(container);
          return;
        }
        
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á map ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ -> { codename, rank }
        console.log('=== Creating phone map from members ===');
        const phoneMap = {};
        if (members && Array.isArray(members)) {
          console.log('üë• Processing', members.length, 'members');
          members.forEach((m, idx) => {
            const phone = String(m.phone || '').replace(/[^\d]/g, "");
            if (phone) {
              phoneMap[phone] = { 
                codename: m.codename || '', 
                rank: m.rank || '' 
              };
            }
            if (idx < 3) {
              console.log(`üë§ Member ${idx}:`, {
                phone: m.phone,
                cleaned: phone,
                codename: m.codename,
                rank: m.rank
              });
            }
          });
        } else {
          console.warn('‚ö†Ô∏è Members is not an array:', members);
        }
        
        console.log('üì± Phone map created with', Object.keys(phoneMap).length, 'entries');
        console.log('üì± Sample phone keys:', Object.keys(phoneMap).slice(0, 5));
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï codename ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
        if (data.participants && Array.isArray(data.participants)) {
          console.log('=== Processing', data.participants.length, 'participants ===');
          if (data.participants.length > 0) {
            console.log('üìù First participant all columns:', Object.keys(data.participants[0]));
            console.log('üìù First participant sample:', JSON.stringify(data.participants[0], null, 2).substring(0, 500));
          }
          
          data.participants.forEach((participant, index) => {
            // ‡πÉ‡∏ä‡πâ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏à‡∏≤‡∏Å column D (‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠)
            const originalPhone = participant['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (0xx-xxx-xxxx)'] || 
                                 participant['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠'] || 
                                 participant['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£'] ||
                                 participant['Phone'] ||
                                 participant['phone'] ||
                                 participant.phone || 
                                 '';
            const phone = String(originalPhone).replace(/[^\d]/g, "");
            
            if (index < 3) {
              console.log(`üë§ Participant ${index}:`, {
                originalPhone: originalPhone,
                cleanedPhone: phone,
                foundInMap: !!phoneMap[phone],
                codename: phoneMap[phone]?.codename || '‡πÑ‡∏°‡πà‡∏û‡∏ö',
                rank: phoneMap[phone]?.rank || '‡πÑ‡∏°‡πà‡∏û‡∏ö',
                allColumns: Object.keys(participant)
              });
            }
            
            if (phoneMap[phone]) {
              participant.codename = phoneMap[phone].codename;
              participant.rank = phoneMap[phone].rank;
            }
          });
          
          // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà displayUsers ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á
          console.log('=== Converting participants data ===');
          const convertedData = {
            users: data.participants.map((p, idx) => {
              // ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏≤‡∏Å column C
              const nickname = p['‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô'] || p['‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•'] || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠';
              
              // ‡πÉ‡∏ä‡πâ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏à‡∏≤‡∏Å column D
              const phone = p['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (0xx-xxx-xxxx)'] || p['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠'] || p['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£'] || p['Phone'] || p['phone'] || p.phone || '';
              
              // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Box ‡∏à‡∏≤‡∏Å column E (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠)
              let boxes = 0;
              const boxData = p['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (1 BOX = 1,550 ‡∏ö‡∏≤‡∏ó, 1 C/)'] || 
                             p['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠'] || 
                             p['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Box'] || '';
              
              if (boxData && typeof boxData === 'string') {
                // ‡∏•‡∏≠‡∏á‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Box ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                const boxMatch = boxData.match(/(\d+)\s*(?:BOX|Box|box|‡∏Å‡∏•‡πà‡∏≠‡∏á)/);
                if (boxMatch) {
                  boxes = parseInt(boxMatch[1]) || 0;
                } else {
                  // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ BOX ‡∏•‡∏≠‡∏á‡∏´‡∏≤‡πÅ‡∏Ñ‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
                  const numMatch = boxData.match(/(\d+)/);
                  if (numMatch) {
                    boxes = parseInt(numMatch[1]) || 0;
                  }
                }
              } else if (typeof boxData === 'number') {
                boxes = boxData;
              }
              
              // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Spot - ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
              // ‡∏ï‡∏±‡∏î Spot ‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß
              let spots = 0;
              
              // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• promo cards ‡∏à‡∏≤‡∏Å participant
              let promoCards = [];
              if (p.promoCards && Array.isArray(p.promoCards)) {
                promoCards = p.promoCards;
              } else if (p.promoPacks && p.promoPacks > 0) {
                // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ promoCards ‡πÅ‡∏ï‡πà‡∏°‡∏µ promoPacks ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà
                const promoPacks = Math.floor(boxes / 2);
                if (promoPacks > 0) {
                  // ‡∏™‡∏∏‡πà‡∏°‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏° (‡πÉ‡∏ä‡πâ phone + index ‡πÄ‡∏õ‡πá‡∏ô seed)
                  for (let pIdx = 0; pIdx < promoPacks; pIdx++) {
                    const cardIndex = (phone.length + pIdx) % 4;
                    promoCards.push({
                      number: ['047', '048', '049', '050'][cardIndex],
                      imageUrl: `https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_MPromo_${['047', '048', '049', '050'][cardIndex]}.png`
                    });
                  }
                }
              }
              
              // Debug logging ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 3 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å
              if (idx < 3) {
                console.log(`üë§ Converting User ${idx} (${nickname}):`, {
                  boxData: boxData,
                  boxes: boxes,
                  spots: spots,
                  promoCards: promoCards.length,
                  codename: p.codename || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏',
                  rank: p.rank || '',
                  availableColumns: Object.keys(p).slice(0, 10)
                });
              }
              
              return {
                nickname: nickname,
                phone: phone,
                boxes: boxes,
                spots: spots,
                promoCards: promoCards,
                codename: p.codename || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏',
                rank: p.rank || '',
                attendingParty: p['‡∏°‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô Midnight Party ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà'] || p['‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô'] || ''
              };
            }),
            total: data.participants.length,
            totalBoxes: data.participants.reduce((sum, p) => {
              const boxData = p['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (1 BOX = 1,550 ‡∏ö‡∏≤‡∏ó, 1 C/)'] || 
                             p['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠'] || 
                             p['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Box'] || '';
              if (boxData && typeof boxData === 'string') {
                const boxMatch = boxData.match(/(\d+)\s*(?:BOX|Box|box|‡∏Å‡∏•‡πà‡∏≠‡∏á)/);
                if (boxMatch) {
                  return sum + (parseInt(boxMatch[1]) || 0);
                } else {
                  const numMatch = boxData.match(/(\d+)/);
                  if (numMatch) {
                    return sum + (parseInt(numMatch[1]) || 0);
                  }
                }
              } else if (typeof boxData === 'number') {
                return sum + boxData;
              }
              return sum;
            }, 0),
            totalSpots: 0 // ‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Spot
          };
          
          console.log('=== Conversion Summary ===');
          console.log('üìä Total users after conversion:', convertedData.users.length);
          console.log('üìä Total boxes:', convertedData.totalBoxes);
          console.log('üìä Total spots:', convertedData.totalSpots);
          console.log('üìä Sample converted users (first 3):', convertedData.users.slice(0, 3));
          
          displayUsers(convertedData);
        }
      }).catch(error => {
        console.error('‚ùå Fetch error:', error);
        showFallbackData(container);
      });
    }

    function showFallbackData(container) {
      console.log('‚ö†Ô∏è ========== showFallbackData called ==========');
      console.log('‚ö†Ô∏è Container element:', container);
      console.log('‚ö†Ô∏è This means data could not be loaded');
      
      // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏õ‡πá‡∏ô 0
      const totalUsersEl = document.getElementById('totalUsers');
      const totalBoxesEl = document.getElementById('totalBoxes');
      // const totalSpotsEl = document.getElementById('totalSpots'); // ‡πÄ‡∏≠‡∏≤ Spot ‡∏≠‡∏≠‡∏Å
      
      console.log('üìä Updating stats to 0');
      console.log('üìä totalUsers element:', totalUsersEl);
      console.log('üìä totalBoxes element:', totalBoxesEl);
      // console.log('üìä totalSpots element:', totalSpotsEl);
      
      if (totalUsersEl) totalUsersEl.textContent = '0';
      if (totalBoxesEl) totalBoxesEl.textContent = '0';
      // if (totalSpotsEl) totalSpotsEl.textContent = '0';
      
      // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
      let errorMessage = '<div class="error-message">';
      errorMessage += '‚ö†Ô∏è <strong>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ</strong><br><br>';
      errorMessage += 'üìå <strong>‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:</strong> Google Apps Script ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Deploy ‡πÄ‡∏õ‡πá‡∏ô Web App ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á<br><br>';
      errorMessage += '‚úÖ <strong>‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin):</strong><br>';
      errorMessage += '   1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà <a href="https://script.google.com" target="_blank" style="color: #ffd700;">Google Apps Script Editor</a><br>';
      errorMessage += '   2. ‡πÄ‡∏õ‡∏¥‡∏î script "MA3 Preorder"<br>';
      errorMessage += '   3. ‡∏Ñ‡∏•‡∏¥‡∏Å <strong>Deploy</strong> ‚Üí <strong>Manage deployments</strong><br>';
      errorMessage += '   4. ‡∏Ñ‡∏•‡∏¥‡∏Å <strong>Edit</strong> ‡∏´‡∏£‡∏∑‡∏≠ <strong>New deployment</strong><br>';
      errorMessage += '   5. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:<br>';
      errorMessage += '      ‚Ä¢ Type: <strong>Web app</strong><br>';
      errorMessage += '      ‚Ä¢ Execute as: <strong>Me</strong><br>';
      errorMessage += '      ‚Ä¢ Who has access: <strong>Anyone</strong> (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!)<br>';
      errorMessage += '   6. ‡∏Ñ‡∏•‡∏¥‡∏Å <strong>Deploy</strong><br>';
      errorMessage += '   7. Copy URL ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î HTML (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î apiUrl)<br><br>';
      errorMessage += 'üí° <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å Deploy ‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ<br><br>';
      errorMessage += 'üîÑ <button onclick="loadRegisteredUsers()" style="background:#6bcf7f;color:#fff;border:none;padding:0.5rem 1rem;border-radius:5px;cursor:pointer;font-weight:bold;">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>';
      errorMessage += '</div>';
      container.innerHTML = errorMessage;
      console.log('‚ö†Ô∏è Fallback message displayed');
    }

    function displayUsers(data) {
      console.log('=== displayUsers called ===');
      console.log('üìä Input data:', data);
      console.log('üìä data.users exists?', !!data.users);
      console.log('üìä data.users length:', data.users ? data.users.length : 'N/A');
      
      const container = document.getElementById('usersContainer');
      console.log('üì¶ Container element:', container);
      
      if (!data.users || data.users.length === 0) {
        console.log('‚ö†Ô∏è No users to display');
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏õ‡πá‡∏ô 0
        document.getElementById('totalUsers').textContent = '0';
        document.getElementById('totalBoxes').textContent = '0';
        // document.getElementById('totalSpots').textContent = '0';
        container.innerHTML = '<div class="loading">üìù ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</div>';
        console.log('‚úÖ Displayed "no users" message');
        return;
      }
      
      console.log('üìä Processing', data.users.length, 'users');
      
      // ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô
      const userMap = {};
      data.users.forEach(user => {
        const phone = String(user.phone || '').replace(/[^\d]/g, "");
        const key = phone || user.nickname; // ‡πÉ‡∏ä‡πâ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÄ‡∏õ‡πá‡∏ô key ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£
        
        if (userMap[key]) {
          // ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
          userMap[key].boxes += user.boxes || 0;
          userMap[key].spots += user.spots || 0;
          // ‡∏£‡∏ß‡∏° promo cards
          if (user.promoCards && Array.isArray(user.promoCards)) {
            userMap[key].promoCards = (userMap[key].promoCards || []).concat(user.promoCards);
          }
        } else {
          // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
          userMap[key] = {
            nickname: user.nickname,
            codename: user.codename,
            rank: user.rank,
            boxes: user.boxes || 0,
            spots: user.spots || 0,
            promoCards: user.promoCards || [],
            phone: user.phone,
            attendingParty: user.attendingParty || ''
          };
        }
      });
      
      // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô array ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠
      const uniqueUsers = Object.values(userMap).sort((a, b) => a.nickname.localeCompare(b.nickname));
      
      // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß
      const totalUniqueUsers = uniqueUsers.length;
      const totalBoxes = uniqueUsers.reduce((sum, user) => sum + user.boxes, 0);
      const totalSpots = uniqueUsers.reduce((sum, user) => sum + user.spots, 0);
      
      console.log('üìä Stats to display:');
      console.log('üìä Unique users:', totalUniqueUsers);
      console.log('üìä Total boxes:', totalBoxes);
      console.log('üìä Total spots:', totalSpots);
      
      document.getElementById('totalUsers').textContent = totalUniqueUsers;
      document.getElementById('totalBoxes').textContent = totalBoxes;
      // document.getElementById('totalSpots').textContent = totalSpots;
      
      console.log('‚úÖ Stats updated in DOM');
      
      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      let html = '<table style="width:100%; border-collapse:collapse; margin:1rem auto; background:#fff; border-radius:12px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.1); max-width:900px;">';
      html += '<thead><tr style="background:#42A5F5;">';
      html += '<th style="padding:12px 8px; text-align:center; color:#fff; font-weight:bold; font-size:1.05em; width:60px;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>';
      html += '<th style="padding:12px 8px; text-align:center; color:#fff; font-weight:bold; font-size:1.05em;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô / Codename</th>';
      html += '<th style="padding:12px 8px; text-align:center; color:#fff; font-weight:bold; font-size:1.05em; width:140px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Box</th>';
      html += '<th style="padding:12px 8px; text-align:center; color:#fff; font-weight:bold; font-size:1.05em; width:180px;">‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏°</th>';
      html += '<th style="padding:12px 8px; text-align:center; color:#fff; font-weight:bold; font-size:1.05em; width:100px;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</th>';
      html += '</tr></thead><tbody>';
      
      uniqueUsers.forEach((user, index) => {
        html += `<tr style="border-bottom:1px solid #ddd;">`;
        html += `<td style="padding:10px 8px; text-align:center; color:#2c3e50; font-weight:bold;">${index + 1}</td>`;
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡∏∞ codename ‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
        let displayName = user.nickname || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠';
        if (displayName.length > 15) {
          displayName = displayName.substring(0, 15) + '...';
        }
        
        // ‡πÅ‡∏™‡∏î‡∏á codename ‡πÉ‡∏ï‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô
        let codenameDisplay = '';
        if (user.codename && user.codename !== '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏') {
          const rank = user.rank || '';
          const rankEmoji = getRankEmoji(rank);
          let displayCodename = user.codename;
          if (displayCodename.length > 8) {
            displayCodename = displayCodename.substring(0, 8) + '...';
          }
          
          // ‡πÉ‡∏ä‡πâ renderCodenameEffect ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô midnight-party.html
          const codenameHtml = renderCodenameEffect(displayCodename, rank);
          codenameDisplay = `<br><span class="codename-rank" data-rank="${rank}" style="font-size:0.85em;"><span>${rankEmoji}</span> ${codenameHtml} <span>${rankEmoji}</span></span>`;
        }
        
        html += `<td style="padding:12px 8px; text-align:center; color:#2c3e50; font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:300px;">${displayName}${codenameDisplay}</td>`;
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Box ‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß
        let orderDetails = '';
        if (user.boxes > 0) {
          orderDetails += `${user.boxes} üì¶`;
        }
        /* ‡∏ï‡∏±‡∏î Spot ‡∏≠‡∏≠‡∏Å
        if (user.spots > 0) {
          if (orderDetails) orderDetails += ' ';
          orderDetails += `${user.spots} üéØ`;
        }
        */
        if (user.boxes === 0) {
          orderDetails = 'üìù';
        }
        html += `<td style="padding:12px 8px; text-align:center; color:#2c3e50; white-space:nowrap; font-size:0.9em; font-weight:600;">${orderDetails}</td>`;
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö
        let promoDisplay = '';
        if (user.promoCards && user.promoCards.length > 0) {
          promoDisplay = '<div class="user-promo-cards">';
          user.promoCards.forEach(card => {
            promoDisplay += `<img src="${card.imageUrl}" alt="Promo ${card.number}" class="user-promo-card-mini" onclick="openPromoCardModal('${card.imageUrl}')" title="‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏° ${card.number}">`;
          });
          promoDisplay += '</div>';
        } else {
          // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì promo packs ‡∏à‡∏≤‡∏Å boxes
          const promoPacks = Math.floor(user.boxes / 2);
          if (promoPacks > 0) {
            // ‡∏™‡∏∏‡πà‡∏°‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏° (‡πÉ‡∏ä‡πâ phone + index ‡πÄ‡∏õ‡πá‡∏ô seed)
            promoDisplay = '<div class="user-promo-cards">';
            for (let pIdx = 0; pIdx < promoPacks; pIdx++) {
              const phone = String(user.phone || '').replace(/[^\d]/g, "");
              const cardIndex = (phone.length + pIdx) % 4;
              const cardNumber = ['047', '048', '049', '050'][cardIndex];
              const cardImageUrl = `https://asia.pokemon-card.com/th/wp-content/uploads/sites/4/2025/11/th_news_MPromo_${cardNumber}.png`;
              promoDisplay += `<img src="${cardImageUrl}" alt="Promo ${cardNumber}" class="user-promo-card-mini" onclick="openPromoCardModal('${cardImageUrl}')" title="‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏° ${cardNumber}">`;
            }
            promoDisplay += '</div>';
          } else {
            promoDisplay = '<span style="color:#999;">-</span>';
          }
        }
        html += `<td style="padding:12px 8px; text-align:center; color:#2c3e50; font-size:0.9em;">${promoDisplay}</td>`;
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô
        const attending = user.attendingParty && (user.attendingParty.toLowerCase().includes('‡πÉ‡∏ä‡πà') || user.attendingParty.toLowerCase().includes('yes') || user.attendingParty.toLowerCase().includes('y'));
        html += `<td style="padding:12px 8px; text-align:center; color:#2c3e50; font-size:0.9em; font-weight:600;">${attending ? '‚úÖ' : '‚ùå'}</td>`;
        
        html += '</tr>';
      });
      
      html += '</tbody></table>';
      container.innerHTML = html;
      console.log('‚úÖ Table HTML generated and inserted');
      console.log('‚úÖ displayUsers completed');
    }

    // Rank emoji map
    const rankEmojis = {
      "Rookie": "üê£", "Rookie II": "üê£", "Rookie III": "üê£", "Rookie IV": "üê£", "Rookie V": "üê£",
      "Bronze": "üõ°Ô∏è", "Bronze II": "üõ°Ô∏è", "Bronze III": "üõ°Ô∏è", "Bronze IV": "üõ°Ô∏è", "Bronze V": "üõ°Ô∏è",
      "Silver": "‚öîÔ∏è", "Silver II": "‚öîÔ∏è", "Silver III": "‚öîÔ∏è", "Silver IV": "‚öîÔ∏è", "Silver V": "‚öîÔ∏è",
      "Gold": "ü•á", "Gold II": "ü•á", "Gold III": "ü•á", "Gold IV": "ü•á", "Gold V": "ü•á",
      "Platinum": "‚ú®", "Platinum II": "‚ú®", "Platinum III": "‚ú®", "Platinum IV": "‚ú®", "Platinum V": "‚ú®",
      "Diamond": "üíé", "Diamond II": "üíé", "Diamond III": "üíé", "Diamond IV": "üíé", "Diamond V": "üíé",
      "Grandmaster": "üëë", "Grandmaster II": "üëë", "Grandmaster III": "üëë", "Grandmaster IV": "üëë", "Grandmaster V": "üëë",
      "Legend": "üêâ", "Legend II": "üêâ", "Legend III": "üêâ", "Legend IV": "üêâ", "Legend V": "üêâ"
    };

    function getBaseRank(rank) {
      if (!rank) return "Rookie";
      const baseRank = rank.replace(/\s+(II|III|IV|V|VI|VII|VIII|IX|X|\d+)$/, '');
      return baseRank || "Rookie";
    }

    function getRankEmoji(rank) {
      if (!rank) return rankEmojis["Rookie"] || "üê£";
      if (rankEmojis[rank]) return rankEmojis[rank];
      const baseRank = getBaseRank(rank);
      return rankEmojis[baseRank] || rankEmojis["Rookie"] || "üê£";
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô renderCodenameEffect ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô midnight-party.html
    function renderCodenameEffect(codename, rank) {
      const chars = ['[', ...codename.split(''), ']'];
      const waveRanks = ['Gold', 'Platinum', 'Diamond', 'Grandmaster', 'Legend'];
      const baseRank = getBaseRank(rank);
      if (waveRanks.includes(baseRank)) {
        // wave + class ‡∏ï‡∏≤‡∏° rank, ‡πÉ‡∏™‡πà‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏Ç‡∏¢‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢
        return `<span class="codename wave ${baseRank.toLowerCase()}">${chars.map((ch,i)=>`<span>${ch}</span>`).join('')}</span>`;
      } else {
        // ‡πÉ‡∏™‡πà‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤
        return `<span class="codename">[${codename}]</span>`;
      }
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î Modal ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏°
    function openPromoCardModal(imageUrl) {
      const modal = document.getElementById('promoCardModal');
      const modalImage = document.getElementById('promoCardModalImage');
      if (modal && modalImage) {
        modalImage.src = imageUrl;
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden'; // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô scroll ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î modal
      }
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏¥‡∏î Modal ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏°
    function closePromoCardModal() {
      const modal = document.getElementById('promoCardModal');
      if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto'; // ‡πÄ‡∏õ‡∏¥‡∏î scroll ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
      }
    }

    // ‡∏õ‡∏¥‡∏î Modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ô‡∏≠‡∏Å‡∏†‡∏≤‡∏û
    document.addEventListener('DOMContentLoaded', function() {
      const modal = document.getElementById('promoCardModal');
      if (modal) {
        modal.addEventListener('click', function(event) {
          if (event.target === modal) {
            closePromoCardModal();
          }
        });
      }

      // ‡∏õ‡∏¥‡∏î Modal ‡∏î‡πâ‡∏ß‡∏¢‡∏õ‡∏∏‡πà‡∏° Escape
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          closePromoCardModal();
        }
      });
    });
  </script>
</body>
</html>
