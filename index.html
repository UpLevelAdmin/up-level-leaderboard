<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Up Level Guild - Leaderboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <img src="https://i.postimg.cc/wjzpnxjB/Up-Level-01-1.png" alt="Up Level Logo" class="logo">
  <h1>ğŸ† Up Level Guild - Leaderboard</h1>
  <div id="leaderboard">Loading...</div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbwJoXR9EFLngOAyA_WjQJNE0zT3MmL2afwlwvxmnMQ88WYzjlD-l2c_LXjg-k3bFWj9/exec";

    const emojiMap = {
      "Rookie": "ğŸ£",
      "Bronze": "ğŸ›¡ï¸",
      "Silver": "âš”ï¸",
      "Gold": "ğŸ…",
      "Platinum": "â­",
      "Diamond": "ğŸ’",
      "Grandmaster": "ğŸ‘‘",
      "Legend": "ğŸ‰"
    };

    fetch(scriptURL)
      .then(response => response.json())
      .then(data => {
        if (!data || data.length === 0) {
          document.getElementById("leaderboard").innerHTML = "<p class='empty'>â³ à¸£à¸­à¸ªà¸¡à¸²à¸Šà¸´à¸à¸„à¸™à¹à¸£à¸à¸‚à¸­à¸‡à¸à¸´à¸¥à¸”à¹Œ...</p>";
          return;
        }

        let html = "<table><thead><tr><th>à¸­à¸±à¸™à¸”à¸±à¸š</th><th>Codename</th><th>Rank</th><th>EXP</th><th>Party</th></tr></thead><tbody>";
        data.forEach((row, index) => {
          const rank = row["Rank"] || "-";
          const emoji = emojiMap[rank] || "";
          const rankHTML = `<span class='rank-${rank}' style='white-space: nowrap;'>${emoji} ${rank} ${emoji}</span>`;
          html += `<tr>
            <td>${index + 1}</td>
            <td>${row["Codename"] || "-"}</td>
            <td>${rankHTML}</td>
            <td>${row["EXP"] || "0"}</td>
            <td>${row["Party"] || "-"}</td>
          </tr>`;
        });
        html += "</tbody></table>";
        document.getElementById("leaderboard").innerHTML = html;
      })
      .catch(err => {
        document.getElementById("leaderboard").innerText = "âŒ à¹‚à¸«à¸¥à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ";
        console.error(err);
      });
  </script>

  <div class="rank-system">
    <h2>ğŸ¥‡ Rank System</h2>
    <table class="rank-table">
      <tr><th>Rank</th><th>EXP Range</th></tr>
      <tr><td>ğŸ£ Rookie</td><td>0â€“4</td></tr>
      <tr><td>ğŸ›¡ï¸ Bronze</td><td>5â€“14</td></tr>
      <tr><td>âš”ï¸ Silver</td><td>15â€“29</td></tr>
      <tr><td>ğŸ¥‡ Gold</td><td>30â€“49</td></tr>
      <tr><td>â­ Platinum</td><td>50â€“74</td></tr>
      <tr><td>ğŸ’ Diamond</td><td>75â€“119</td></tr>
      <tr><td>ğŸ‘‘ Grandmaster</td><td>120â€“199</td></tr>
      <tr><td>ğŸ‰ Legend</td><td>200+</td></tr>
    </table>
  </div>

</body>
</html>
