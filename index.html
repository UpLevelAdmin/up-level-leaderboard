<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Up Level Guild - Leaderboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <img src="https://i.postimg.cc/wjzpnxjB/Up-Level-01-1.png" alt="Up Level Logo" class="logo">
  <h1>üèÜ Up Level Guild - Leaderboard</h1>
  <div id="leaderboard">Loading...</div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbwJoXR9EFLngOAyA_WjQJNE0zT3MmL2afwlwvxmnMQ88WYzjlD-l2c_LXjg-k3bFWj9/exec";

    const emojiMap = {
      "Rookie": "üê£",
      "Bronze": "üõ°Ô∏è",
      "Silver": "‚öîÔ∏è",
      "Gold": "üèÖ",
      "Platinum": "‚≠ê",
      "Diamond": "üíé",
      "Grandmaster": "üëë",
      "Legend": "üêâ"
    };

    fetch(scriptURL)
      .then(response => response.json())
      .then(data => {
        if (!data || data.length === 0) {
          document.getElementById("leaderboard").innerHTML = "<p class='empty'>‚è≥ ‡∏£‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏•‡∏î‡πå...</p>";
          return;
        }

        let html = "<table><thead><tr><th>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th><th>Codename</th><th>Rank</th><th>EXP</th><th>Party</th></tr></thead><tbody>";
        data.forEach((row, index) => {
          const rank = row["Rank"] || "-";
          const emoji = emojiMap[rank] || "";
          const rankHTML = `<span class='rank-${rank}' style='white-space: nowrap;'>${emoji} ${rank} ${emoji}</span>`;
          html += `<tr>
            <td>${index + 1}</td>
            <td>${row["Codename"] || "-"}</td>
            <td>${rankHTML}</td>
            <td>${row["EXP"] || "0"}</td>
            <td>${row["Party"] || "-"}</td>
          </tr>`;
        });
        html += "</tbody></table>";
        document.getElementById("leaderboard").innerHTML = html;
      })
      .catch(err => {
        document.getElementById("leaderboard").innerText = "‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        console.error(err);
      });
  </script>
</body>
</html>
