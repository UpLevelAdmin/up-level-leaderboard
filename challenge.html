<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .challenge-card {
      background-color: #fff;
      padding: 1rem;
      border-radius: 1rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 1rem;
    }
    .form-section {
      margin-top: 2rem;
      display: none;
    }
    button {
      padding: 0.5rem 1rem;
      border-radius: 8px;
      border: none;
      background-color: #4f46e5;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background-color: #3730a3;
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="https://i.postimg.cc/wjzpnxjB/Up-Level-01-1.png" alt="logo" class="logo" />
    <h2>üì£ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</h2>
    <div id="challenge-list"></div>

    <button onclick="toggleForm()">+ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤</button>

    <div class="form-section" id="challenge-form">
      <h3>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤</h3>
      <form id="submit-form">
        <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</label><br />
        <input type="text" name="phone" required /><br />

        <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤:</label><br />
        <select name="type">
          <option value="open">Open</option>
          <option value="direct">Direct</option>
        </select><br />

        <label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á:</label><br />
        <select name="mode">
          <option value="Standard BO1">Standard BO1</option>
          <option value="Standard BO3">Standard BO3</option>
          <option value="Asia Wide">Asia Wide</option>
        </select><br />

        <label>‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏±‡∏ô/‡πÄ‡∏£‡∏µ‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô:</label><br />
        <input type="text" name="wager" /><br />

        <label>‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤:</label><br />
        <input type="text" name="title" /><br /><br />

        <button type="submit">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤</button>
      </form>
    </div>
  </div>

  <script>
    function toggleForm() {
      const form = document.getElementById("challenge-form");
      form.style.display = form.style.display === "none" ? "block" : "none";
    }

    async function fetchChallenges() {
      const res = await fetch(
        "https://script.google.com/macros/s/AKfycbwJoXR9EFLngOAyA_WjQJNE0zT3MmL2afwlwvxmnMQ88WYzjlD-l2c_LXjg-k3bFWj9/exec?func=getChallengeList"
      );
      const data = await res.json();
      const container = document.getElementById("challenge-list");
      container.innerHTML = "";
      data.filter(c => c[8] === "‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥").forEach(item => {
        const card = document.createElement("div");
        card.className = "challenge-card";
        card.innerHTML = `<strong>${item[2]}</strong> ‡∏ó‡πâ‡∏≤ <em>${item[4] || "‡∏™‡∏≤‡∏ò‡∏≤‡∏£"}</em><br />
          ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: ${item[5]}<br />
          ‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏±‡∏ô: ${item[6]}<br />
          ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤: ${item[7]}`;
        container.appendChild(card);
      });
    }

    document.getElementById("submit-form").addEventListener("submit", async function (e) {
      e.preventDefault();
      const form = e.target;
      const data = {
        phone: form.phone.value,
        type: form.type.value,
        target: "-",
        mode: form.mode.value,
        wager: form.wager.value,
        title: form.title.value
      };

      const res = await fetch(
        "https://script.google.com/macros/s/AKfycbwJoXR9EFLngOAyA_WjQJNE0zT3MmL2afwlwvxmnMQ88WYzjlD-l2c_LXjg-k3bFWj9/exec?func=submitChallengeRequest",
        {
          method: "POST",
          body: JSON.stringify(data),
          headers: { "Content-Type": "application/json" }
        }
      );
      const text = await res.text();
      alert(text);
      form.reset();
      fetchChallenges();
    });

    window.onload = fetchChallenges;
  </script>
</body>
</html>
