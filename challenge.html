<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢ | Up Level Guild</title>
  <style>
  .challenge-card {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: white;
    border-radius: 10px;
    padding: 0.75rem;
    margin: 0.75rem auto;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.05);
    max-width: 600px;
    font-size: 0.95rem;
    flex-wrap: wrap;
  }
  .challenge-type {
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 6px;
    color: white;
    margin-right: 10px;
    font-size: 0.8rem;
  }
  .challenge-type.open { background: #007bff; }
  .challenge-type.direct { background: #ff4136; }
  .challenge-main {
    flex-grow: 1;
    margin: 5px 0;
  }
  .challenge-main p {
    margin: 2px 0;
  }
  .challenge-actions {
    display: flex;
    align-items: center;
    gap: 5px;
  }
  .button-primary {
    background-color: #4caf50;
    color: white;
    padding: 0.4rem 0.8rem;
    font-size: 0.85rem;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  .detail-section {
    width: 100%;
    padding: 0.5rem;
    background: #f9f9f9;
    border-radius: 8px;
    margin-top: 0.5rem;
    font-size: 0.85rem;
    display: none;
  }
  .button-secondary {
    background: none;
    border: none;
    color: #007bff;
    cursor: pointer;
    padding: 0;
    font-size: 0.8rem;
  }
</style>
</head>
<body>
  <img src="https://i.postimg.cc/wjzpnxjB/Up-Level-01-1.png" alt="Up Level Guild" style="width: 150px; margin-bottom: 10px;" />
  <h1>üì¢ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢</h1>
  <div id="challenge-list">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>

  <button id="show-form-btn" class="button-primary">+ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤</button>

  <form id="challenge-form" class="hidden">
    <label>üì± ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</label>
    <input type="text" id="phone" pattern="\d*" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ 10 ‡∏´‡∏•‡∏±‡∏Å" required />
    <button type="button" id="verify-btn" class="button-primary">üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>

    <p id="codename-display" style="font-weight:bold;"></p>
    <div id="form-fields" class="hidden">
      <p>üí• ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤</p>
      <select id="type">
        <option value="open">Open Challenge</option>
        <option value="direct">Direct Challenge</option>
      </select>

      <div id="target-select-container" class="hidden">
        <label>üéØ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏ñ‡∏π‡∏Å‡∏ó‡πâ‡∏≤:</label>
        <select id="target"></select>
      </div>

      <label>‚öîÔ∏è ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á:</label>
      <select id="mode">
        <option value="Standard BO1">Standard BO1</option>
        <option value="Standard BO3">Standard BO3</option>
        <option value="Standard BO5">Standard BO5</option>
        <option value="Asia Wide">Asia Wide</option>
      </select>

      <label>üéÅ ‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏±‡∏ô / ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç:</label>
      <input type="text" id="wager" placeholder="‡πÄ‡∏ä‡πà‡∏ô EXP 1, ‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ô‡πâ‡∏≥, ‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏°" />

      <label>üìù ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏à‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠):</label>
      <input type="text" id="title" placeholder="‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡∏à‡∏∞‡∏™‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ" />

      <button type="submit" class="button-primary">‚ú® ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
    </div>
  </form>

  <p>üì≤ ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤: 
    <a href="https://www.facebook.com/uplevelacademy" target="_blank">Facebook Page</a> | 
    <a href="https://lin.ee/qlM5nVG" target="_blank">LINE Official</a></p>

  <div id="accept-form" class="hidden">
    <h3>‚úÖ ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤</h3>
    <label>üì± ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</label>
    <input type="text" id="accept-phone" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ 10 ‡∏´‡∏•‡∏±‡∏Å" />

    <label>üë§ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</label>
    <input type="text" id="accept-fullname" placeholder="‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô" />

    <input type="hidden" id="accept-id" />
    <input type="hidden" id="accept-type" />
    <input type="hidden" id="accept-target" />
    <button onclick="submitAccept()" class="button-primary">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤</button>
  </div>

  <style>
  .challenge-card {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: white;
    border-radius: 10px;
    padding: 0.75rem;
    margin: 0.75rem auto;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.05);
    max-width: 600px;
    font-size: 0.95rem;
    flex-wrap: wrap;
  }
  .challenge-type {
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 6px;
    color: white;
    margin-right: 10px;
    font-size: 0.8rem;
  }
  .challenge-type.open { background: #007bff; }
  .challenge-type.direct { background: #ff4136; }
  .challenge-main {
    flex-grow: 1;
    margin: 5px 0;
  }
  .challenge-main p {
    margin: 2px 0;
  }
  .challenge-actions {
    display: flex;
    align-items: center;
    gap: 5px;
  }
  .button-primary {
    background-color: #4caf50;
    color: white;
    padding: 0.4rem 0.8rem;
    font-size: 0.85rem;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  .detail-section {
    width: 100%;
    padding: 0.5rem;
    background: #f9f9f9;
    border-radius: 8px;
    margin-top: 0.5rem;
    font-size: 0.85rem;
    display: none;
  }
  .button-secondary {
    background: none;
    border: none;
    color: #007bff;
    cursor: pointer;
    padding: 0;
    font-size: 0.8rem;
  }
</style>

<script>
  const endpoint = "https://script.google.com/macros/s/AKfycbwJoXR9EFLngOAyA_WjQJNE0zT3MmL2afwlwvxmnMQ88WYzjlD-l2c_LXjg-k3bFWj9/exec";
  const listDiv = document.getElementById("challenge-list");

  async function loadChallenges() {
    listDiv.innerHTML = "üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤...";
    try {
      const res = await fetch(endpoint + "?func=getChallengeList");
      const all = await res.json();
      const approved = all.filter(row => row["‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤"] === "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥");

      if (approved.length === 0) {
        listDiv.innerHTML = "<p>üì≠ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢<br>‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!</p>";
      } else {
        listDiv.innerHTML = "";
        for (let row of approved) {
          const type = row["‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó"] || "open";
          const codename = row["Codename"] || "-";
          const wager = row["‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏±‡∏ô"] || "-";
          const targetName = row["‡∏ú‡∏π‡πâ‡∏ñ‡∏π‡∏Å‡∏ó‡πâ‡∏≤"] || "-";
          const title = row["‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤"] || "-";
          const mode = row["‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö"] || "-";
          const accepted = row["‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö"];

          const card = document.createElement("div");
          card.className = "challenge-card";

          const typeTag = `<span class="challenge-type ${type}">${type.toUpperCase()}</span>`;
          const detailId = `detail-${row["ID"]}`;

          card.innerHTML = `
            ${typeTag}
            <div class="challenge-main">
              <p>üëë ${codename} ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ó‡πâ‡∏≤ ‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏±‡∏ô: ${wager}</p>
              <button class="button-secondary" onclick="document.getElementById('${detailId}').classList.toggle('hidden')">üîé ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
              <div id="${detailId}" class="detail-section hidden">
                ${type === "direct" ? `üéØ ‡∏ú‡∏π‡πâ‡∏ñ‡∏π‡∏Å‡∏ó‡πâ‡∏≤: ${targetName}<br>` : ""}
                üìù ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤: ${title}<br>
                üéÆ ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: ${mode}<br>
                ${accepted ? `üìå ‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö: ${accepted}` : ""}
              </div>
            </div>
            <div class="challenge-actions">
              ${!accepted
                ? `<button class="button-primary" onclick="showAcceptForm('${row["ID"]}', '${type}', '${targetName}')">‚úÖ ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤</button>`
                : `<p class="duel-ready">üî• ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏î‡∏ß‡∏•</p>`
              }
            </div>
          `;

          listDiv.appendChild(card);
        }
      }
    } catch {
      listDiv.innerHTML = "<p>‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏ó‡πâ‡∏≤‡πÑ‡∏î‡πâ</p>";
    }
  }

  loadChallenges();
</script>


</body>
</html>
