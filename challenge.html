
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>🧩 สร้างคำท้า | Up Level Guild</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <img src="https://i.postimg.cc/wjzpnxjB/Up-Level-01-1.png" class="logo" />
    <h1>🧩 สร้างคำท้า</h1>

    <form onsubmit="submitChallenge(); return false;">
      <input type="tel" id="phone" placeholder="เบอร์โทรของคุณ" required /><br />
      <select id="type" onchange="toggleTargetInput()" required>
        <option value="">-- เลือกประเภทคำท้า --</option>
        <option value="open">Open Challenge</option>
        <option value="direct">Direct Challenge</option>
      </select><br />

      <div id="targetBox" style="display:none;">
        <input type="text" id="target" placeholder="Codename ผู้ถูกท้า" />
      </div>

      <select id="mode" required>
        <option value="">-- เลือกรูปแบบการแข่งขัน --</option>
        <option value="Standard BO1">Standard BO1</option>
        <option value="Standard BO3">Standard BO3</option>
        <option value="Standard BO5">Standard BO5</option>
        <option value="Asia Wide">Asia Wide</option>
      </select><br />

      <input type="text" id="wager" placeholder="เดิมพัน (เช่น เลี้ยงขนม, EXP 3)" /><br />
      <input type="text" id="title" placeholder="ชื่อคำท้า (ไม่บังคับ)" /><br />
      <button type="submit">🚀 ส่งคำท้า</button>
    </form>

    <footer>📣 อย่าลืมแจ้งแอดมินในเพจหรือ LINE OA เพื่ออนุมัติคำท้าของคุณ</footer>
  </div>

  <script>
    const scriptId = 'AKfycbwJoXR9EFLngOAyA_WjQJNE0zT3MmL2afwlwvxmnMQ88WYzjlD-l2c_LXjg-k3bFWj9';

    function toggleTargetInput() {
      const type = document.getElementById("type").value;
      document.getElementById("targetBox").style.display = type === "direct" ? "block" : "none";
    }

    function submitChallenge() {
      const phone = document.getElementById("phone").value.trim();
      const type = document.getElementById("type").value;
      const target = document.getElementById("target").value || "-";
      const mode = document.getElementById("mode").value;
      const wager = document.getElementById("wager").value || "-";
      const title = document.getElementById("title").value || generateTitle();

      fetch(`https://script.google.com/macros/s/${scriptId}/exec?func=submitChallengeRequest`, {
        method: 'POST',
        body: JSON.stringify({ phone, type, target, mode, wager, title }),
        headers: { 'Content-Type': 'application/json' },
        mode: 'no-cors'
      })
      .then(() => {
        alert("✅ ส่งคำท้าเรียบร้อยแล้ว! รอแอดมินอนุมัติ");
        document.querySelector("form").reset();
        toggleTargetInput();
      })
      .catch(() => {
        alert("เกิดข้อผิดพลาด");
      });
    }

    function generateTitle() {
      const formats = [
        "🔥 ดวลไฟ เดือดแน่นอน", "⚡ ศึกสายฟ้า", "💥 ตัดสินศึก!", "🎯 เป้าหมายมีไว้พิชิต",
        "🥊 พร้อมซัด!", "🌀 วนลูปแห่งชัย", "🌈 ปะทะสายรุ้ง", "☠️ ศึกเดือดไร้พ่าย",
        "🧠 ดวลปัญญา", "💫 กระหน่ำใส่ไม่ยั้ง", "📣 ศึกข้ามตี้", "🧩 ดวลมันส์พันธุ์แท้",
        "👑 ชิงบัลลังก์", "🕹️ เกมนี้ต้องชนะ", "🗡️ แทงใจดำ!", "🚨 ดวลไม่ยั้ง!",
        "🏆 ใครจะเป็นที่ 1?", "🤺 ศึกคู่แค้น", "🌟 ท้าพิสูจน์ฝีมือ", "💣 ปะทะครั้งสุดท้าย"
      ];
      return formats[Math.floor(Math.random() * formats.length)];
    }
  </script>
</body>
</html>
