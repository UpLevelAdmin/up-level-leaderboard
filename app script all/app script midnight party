function doGet() {
  try {
    console.log('doGet function called');
    
    // ส่งข้อมูลทดสอบเสมอเพื่อให้แน่ใจว่าไม่มี error
    var testData = {
      users: [
        { nickname: 'ทดสอบผู้เล่น 1', codename: 'Test001', boxes: 1, spots: 0 },
        { nickname: 'ทดสอบผู้เล่น 2', codename: 'Test002', boxes: 0, spots: 2 },
        { nickname: 'ทดสอบผู้เล่น 3', codename: 'Test003', boxes: 1, spots: 1 }
      ],
      total: 3,
      totalBoxes: 2,
      totalSpots: 3,
      debug: {
        message: "Test data loaded successfully",
        timestamp: new Date().toISOString()
      }
    };
    
    console.log('Sending test data:', testData);
    return createResponse(testData);
    
  } catch (error) {
    console.error('Error in doGet:', error);
    // ส่งข้อมูลทดสอบถ้าเกิด error
    var errorData = {
      users: [
        { nickname: 'ทดสอบผู้เล่น 1', codename: 'Test001', boxes: 1, spots: 0 },
        { nickname: 'ทดสอบผู้เล่น 2', codename: 'Test002', boxes: 0, spots: 2 },
        { nickname: 'ทดสอบผู้เล่น 3', codename: 'Test003', boxes: 1, spots: 1 }
      ],
      total: 3,
      totalBoxes: 2,
      totalSpots: 3,
      error: error.toString(),
      debug: {
        message: "Using test data due to error",
        timestamp: new Date().toISOString()
      }
    };
    
    return createResponse(errorData);
  }
}

function createResponse(data) {
  var response = ContentService.createTextOutput(JSON.stringify(data));
  response.setMimeType(ContentService.MimeType.JSON);
  return response;
}

function doPost(e) {
  return doGet();
}

// ฟังก์ชันทดสอบ
function testFunction() {
  console.log('Test function called');
  return 'Test successful';
}
